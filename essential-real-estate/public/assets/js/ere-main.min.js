var ERE=ERE||{};!function(e){"use strict";var t=ere_main_vars.ajax_url,a=ere_main_vars.confirm_yes_text,r=ere_main_vars.confirm_no_text,n=ere_main_vars.loading_text,i=ere_main_vars.decimals,o=ere_main_vars.dec_point,s=ere_main_vars.thousands_sep;ERE={init:function(){this.register_pattern_validator(),this.view_gallery(),this.favorite(),this.tooltip(),this.property_paging(),this.move_link_to_carousel(),this.execute_nav(),this.execute_slider_nav();var t=e(".pagination-image.ere-property-slider");this.sync_property_carousel(t),this.light_gallery()},register_pattern_validator:function(){e.validator.addMethod("pattern",function(e,t,a){return!!this.optional(t)||("string"==typeof a&&(a=new RegExp("^(?:"+a+")$")),a.test(e))},"Invalid format.")},number_format:function(e,t){t=void 0!==t?t:i,e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var a,r,n,l=isFinite(+e)?+e:0,d=isFinite(+t)?Math.abs(t):0,c=void 0===s?",":s,p=void 0===o?".":o,h="";return(h=(d?(a=l,r=d,n=Math.pow(10,r),""+Math.round(a*n)/n):""+Math.round(l)).split("."))[0].length>3&&(h[0]=h[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,c)),(h[1]||"").length<d&&(h[1]=h[1]||"",h[1]+=new Array(d-h[1].length+1).join("0")),h.join(p)},tooltip:function(){e('[data-toggle="tooltip"]').tooltip()},login_modal:function(){e("#ere_signin_modal").modal("show")},get_page_number_from_href:function(e){var t="",a=/paged=\d+/gi;return new RegExp(a).test(e)?t=new RegExp(a).exec(e):(a=/page\/\d+/gi,t=new RegExp(a).test(e)?new RegExp(a).exec(e):t),a=/\d+/g,new RegExp(a).test(t)?new RegExp(a).exec(t)[0]:1},view_gallery:function(){e(".property-view-gallery").on("click",function(a){a.preventDefault();var r=e(this),n=r.attr("data-property-id"),i=r.parent();r.parent().hasClass("on-handle")||(r.parent().addClass("on-handle"),e.ajax({type:"post",url:t,dataType:"json",data:{action:"ere_view_gallery_ajax",property_id:n},beforeSend:function(){r.children("i").addClass("fa-spinner fa-spin")},success:function(t){i.html(t),i.lightGallery({thumbnail:!1}),e(".btn-view-gallery-"+n).trigger("click")},error:function(){r.children("i").removeClass("fa-spinner fa-spin"),r.parent().removeClass("on-handle")}}))})},favorite:function(){e(".property-favorite").on("click",function(a){if(a.preventDefault(),!e(this).hasClass("on-handle")){var r=e(this).addClass("on-handle"),n=r.closest(".property-inner").addClass("property-active-hover"),i=r.attr("data-property-id"),o=r.attr("data-title-not-favorite"),s=r.attr("data-title-favorited");e.ajax({type:"post",url:t,dataType:"json",data:{action:"ere_favorite_ajax",property_id:i},beforeSend:function(){r.children("i").addClass("fa-spinner fa-spin")},success:function(e){void 0!==e.added&&-1!=e.added||ERE.login_modal(),1==e.added?(r.children("i").removeClass("fa-star-o").addClass("fa-star"),r.attr("data-original-title",s)):0==e.added&&(r.children("i").removeClass("fa-star").addClass("fa-star-o"),r.attr("data-original-title",o)),r.children("i").removeClass("fa-spinner fa-spin"),r.removeClass("on-handle"),n.removeClass("property-active-hover")},error:function(){r.children("i").removeClass("fa-spinner fa-spin"),r.removeClass("on-handle"),n.removeClass("property-active-hover")}})}})},light_gallery:function(){e("[data-rel='ere_light_gallery']").each(function(){var t=e(this),a=t.data("gallery-id");t.on("click",function(r){r.preventDefault();var n=[],i=0,o=e(this).attr("href"),s=e(this).data("thumb-src");void 0!==a&&(e('[data-gallery-id="'+a+'"]').each(function(t){var a=e(this).attr("href"),r=e(this).data("thumb-src"),l=e(this).attr("title");a==o&&r==s&&(i=t),void 0===l&&(l=""),n.push({src:a,downloadUrl:a,thumb:r,subHtml:l})}),t.lightGallery({hash:!1,galleryId:a,dynamic:!0,dynamicEl:n,thumbWidth:80,index:i}))})}),e("a.ere-view-video").on("click",function(t){t.preventDefault();var a=e(this).attr("data-src");e(this).lightGallery({dynamic:!0,dynamicEl:[{src:a,thumb:"",subHtml:""}]})})},show_loading:function(t){"undefined"!=t&&""!=t&&null!=t||(t=n);var a=wp.template("ere-processing-template");e("body").append(a({ico:"fa fa-spinner fa-spin",text:t}))},change_loading_status:function(t,a){e("i",".ere-processing").removeClass("fa-spinner fa-spin").addClass(t),e("span",".ere-processing").text(a)},close_loading:function(t){void 0!==t&&null!=t||(t=500),0==t?e(".ere-processing").remove():setTimeout(function(){e(".ere-processing").fadeOut(function(){e(".ere-processing").remove()})},t)},popup_alert:function(t,a,r){var n=wp.template("ere-dialog-template");e("body").append(n({ico:t,message:r})),e("#ere-dialog-popup").dialog({title:a,resizable:!1,closeOnEscape:!0,modal:!0,buttons:{Ok:function(){e(this).dialog("close"),e(this).dialog("destroy").remove()}}})},confirm_dialog:function(t,n,i,o){var s=wp.template("ere-dialog-template");e("body").append(s({ico:"fa fa-question-circle",message:n})),e("#ere-dialog-popup").dialog({title:t,resizable:!1,closeOnEscape:!0,modal:!0,buttons:[{text:a,click:function(){i&&i(),e(this).dialog("destroy").remove()}},{text:r,click:function(){o&&o(),e(this).dialog("close"),e(this).dialog("destroy").remove()}}]})},set_item_effect:function(t,a){if("hide"==a&&(t.css("transition","opacity 1.5s linear, transform 1s"),t.css("-webkit-transition","opacity 1.5s linear, transform 1s"),t.css("-moz-transition","opacity 1.5s linear, transform 1s"),t.css("-ms-transition","opacity 1.5s linear, transform 1s"),t.css("-o-transition","opacity 1.5s linear, transform 1s"),t.css("opacity",0),t.css("transform","scale(0.2)"),t.css("-ms-transform","scale(0.2)"),t.css("-webkit-transform","scale(0.2)")),"show"==a)for(var r=0;r<t.length;r++)!function(a){setTimeout(function(){e(t[a]).css("opacity",1),e(t[a]).css("transform","scale(1)"),e(t[a]).css("-ms-transform","scale(1)"),e(t[a]).css("-webkit-transform","scale(1)")},10*r)}(r)},select_term:function(){var t=e("select.property-filter-mb");t.off(),e(t).on("change",function(t){var a=e(this);a.attr("disabled","disabled"),t.preventDefault();var r=e("option:selected",a).attr("value");a.parent().prev().children('[data-filter="'+r+'"]').click()})},contact_agent_by_email:function(){e(".agent-contact-btn","#contact-agent-form").each(function(){e(this).on("click",function(a){a.preventDefault();var r=e(this),n=e(this).parents("form"),i=e('[name="sender_name"]',n).val(),o=e('[name="sender_phone"]',n).val(),s=e('[name="sender_email"]',n).val(),l=e('[name="sender_msg"]',n).val(),d=!1;null==i||0===i.length?(e(".name-error",n).removeClass("hidden"),d=!0):e(".name-error",n).hasClass("hidden")||e(".name-error",n).addClass("hidden"),null==o||0===o.length?(e(".phone-error",n).removeClass("hidden"),d=!0):e(".phone-error",n).hasClass("hidden")||e(".phone-error",n).addClass("hidden");var c=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;null!=s&&0!==s.length&&c.test(s)?e(".email-error",n).hasClass("hidden")||e(".email-error",n).addClass("hidden"):(e(".email-error",n).removeClass("hidden"),0===s.trim().length||c.test(s)?e(".email-error",n).text(e(".email-error",n).data("error")):e(".email-error",n).text(e(".email-error",n).data("not-valid")),d=!0),null==l||0===l.length?(e(".message-error",n).removeClass("hidden"),d=!0):e(".message-error",n).hasClass("hidden")||e(".message-error",n).addClass("hidden"),r.button({loadingText:'<span class="fa fa-spinner fa-spin"></span>'}),d||(r.button("loading"),e.ajax({type:"post",url:t,dataType:"json",data:n.serialize(),success:function(t){t.success||"function"==typeof ere_reset_recaptcha&&ere_reset_recaptcha(),e(".form-messages",n).html(t.message),r.button("reset")},error:function(){r.button("reset")}}))})})},property_paging:function(){var t=!0;e(".paging-navigation",".property-paging-wrap").each(function(){e("a",e(this)).button({loadingText:'<span class="fa fa-spinner fa-spin"></span>'}),e("a",e(this)).off("click").on("click",function(a){if(a.preventDefault(),t){t=!1;var r=e(this);r.css({padding:"0px",height:r.outerHeight(),width:r.outerWidth()}),r.button("loading");var n=r.attr("href"),i=ERE.get_page_number_from_href(n),o=r.closest(".property-paging-wrap"),s=r.closest(".ere-property").find(".property-content");e.ajax({url:o.data("admin-url"),data:{action:"ere_property_paging_ajax",layout:o.data("layout"),items_amount:o.data("items-amount"),columns:o.data("columns"),image_size:o.data("image-size"),columns_gap:o.data("columns-gap"),view_all_link:o.data("view-all-link"),paged:i,property_type:o.data("property-type"),property_status:o.data("property-status"),property_feature:o.data("property-feature"),property_city:o.data("property-city"),property_state:o.data("property-state"),property_neighborhood:o.data("property-neighborhood"),property_label:o.data("property-label"),property_featured:o.data("property-featured"),author_id:o.data("author-id"),agent_id:o.data("agent-id")},success:function(a){var n=e(".property-item",a),i=e(".property-paging-wrap",a);s.css("opacity",0),s.html(n),ERE.set_item_effect(n,"hide");var o=s.offset().top-30;e("html,body").animate({scrollTop:+o+"px"},500),s.css("opacity",1),s.imagesLoaded(function(){n=e(".property-item",s),ERE.set_item_effect(n,"show"),s.closest(".ere-property").find(".property-paging-wrap").html(i.html()),ERE.property_paging(),ERE.property_paging_control(),ERE.favorite(),ERE.tooltip(),ERE_Compare.register_event_compare()}),r.css({height:"auto",width:"auto",padding:""}),r.button("reset"),t=!0},error:function(){r.css({height:"auto",width:"auto",padding:""}),r.button("reset"),t=!0}})}})})},property_paging_control:function(){e(".paging-navigation",".ere-property").each(function(){var t=e(this);0===t.find("a.next").length?t.addClass("next-disable"):t.removeClass("next-disable")})},move_link_to_carousel:function(){e(".property-carousel").each(function(){var t=e(this);e(".owl-carousel",t).on("owlInitialized",function(){if(void 0!=t.data("view-all-link")&&(t.children(".owl-loaded").hasClass("owl-nav-top-right")||t.children(".owl-loaded").hasClass("owl-nav-bottom-center"))){var e=t.find(".view-all-link");e.length>0&&!t.find(".owl-nav").hasClass("disabled")&&(e.removeClass("mg-top-60 sm-mg-top-40"),t.find(".owl-nav").addClass("has-view-all"),t.find(".owl-nav").append(e[0].outerHTML),e.remove())}t.hasClass("owl-move-nav-par-with-heading")&&t.find(".ere-heading").length>0&&!t.find(".ere-heading").hasClass("heading-contain-owl-nav")&&(t.find(".ere-heading").addClass("heading-contain-owl-nav"),t.find(".owl-nav").addClass("owl-nav-top-right").insertAfter(t.find(".ere-heading").children("h2")))})})},execute_nav:function(){e(".ere-property-carousel").each(function(){var t=e(this),a=e(".navigation-wrap",t),r=e(".owl-carousel .property-item",t);ERE.ere_calc_column_padding(a,r),e(".owl-carousel",t).on("owlInitialized",function(){var t=e(this),r=e(".owl-nav",t);a.length>0&&r.length>0&&r.detach().appendTo(a),ERE.ere_calc_column_padding(a,e(".property-item",t))})})},ere_calc_column_padding:function(e,t){if(e.height()<t.height()){var a=Math.floor((t.height()-e.height())/2);e.css({"padding-top":a+"px","padding-bottom":a+"px"})}},execute_slider_nav:function(){e(".ere-property-slider.navigation-middle").each(function(){ERE.ere_calc_nav_top(e(".owl-carousel",e(this))),e(".owl-carousel",e(this)).on("owlInitialized",function(){var t=e(this);e(".owl-nav",t).addClass("container"),setTimeout(function(){ERE.ere_calc_nav_top(t)},20)})})},ere_calc_nav_top:function(t){var a=e(".owl-nav",t),r=e(".property-item",t).outerHeight(),n=e(".block-center-inner",t).outerHeight(),i=Math.floor((r-n)/2);a.css("top",i+"px")},sync_property_carousel:function(t){var a=e("body").hasClass("rtl"),r=t.find(".property-content-slider"),n=t.find(".property-image-slider");r.owlCarousel({items:1,autoHeight:!0,nav:!1,dots:!1,loop:!1,smartSpeed:500,rtl:a}).on("changed.owl.carousel",function(e){var t=e.item.index;n.find(".owl-item").removeClass("current").eq(t).addClass("current");var a=n.find(".owl-item.active").length-1,r=n.find(".owl-item.active").first().index(),i=n.find(".owl-item.active").last().index();t>i&&n.data("owl.carousel").to(t,500,!0);t<r&&n.data("owl.carousel").to(t-a,500,!0)}),n.on("initialized.owl.carousel",function(){n.find(".owl-item").eq(0).addClass("current")}).owlCarousel({nav:!1,dots:!1,rtl:a,margin:10,responsive:{992:{items:4},768:{items:3},480:{items:2},0:{items:1}}}).on("changed.owl.carousel",function(e){var t=e.item.index;r.data("owl.carousel").to(t,500,!0)}),n.on("click",".owl-item",function(t){if(t.preventDefault(),!e(this).hasClass("current")){var a=e(this).index();r.data("owl.carousel").to(a,500,!0)}})}},e(document).ready(function(){ERE.init()}),e(window).resize(function(){setTimeout(ERE.execute_nav,20),setTimeout(function(){ERE.execute_slider_nav();var t=e(".pagination-image.ere-property-slider");ERE.sync_property_carousel(t)},10)})}(jQuery);